<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Manuál pro FredClient konzoli a knihovnu fred</title><meta name="generator" content="DocBook XSL Stylesheets V1.68.1" /></head><body><div class="book" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h1 class="title"><a id="id2451037"></a>Manuál pro FredClient konzoli a knihovnu fred</h1></div><div><h2 class="subtitle">Verze 1.2</h2></div><div><p class="releaseinfo">
    Vzniklo: 11. 7.2006;
    Revize:  
    18. 8.2006;
     1. 9.2006;
     4. 9.2006;
    14. 9.2006;
    27. 9.2006;
     1.11.2006;
    </p></div><div><p class="copyright">Copyright © 2006 CZ.NIC</p></div></div><hr /></div><div class="toc"><p><b>Obsah</b></p><dl><dt><span class="preface"><a href="#id2489580">Co je FredClient:</a></span></dt><dt><span class="chapter"><a href="#id2489600">1. Licence</a></span></dt><dt><span class="chapter"><a href="#id2489609">2. Požadavky na systém a instalace</a></span></dt><dt><span class="chapter"><a href="#id2489620">3. 
    Popis jednotlivých programů,
       parametry a config
    </a></span></dt><dd><dl><dt><span class="section"><a href="#id2451655">
    Parametry (OPTIONS)
    </a></span></dt><dt><span class="section"><a href="#id2451707">
    Konfigurační soubor
    </a></span></dt></dl></dd><dt><span class="chapter"><a href="#id2452157">4. 
    Program fred_console.py
    </a></span></dt><dd><dl><dt><span class="section"><a href="#id2452190">Zobrazení helpu</a></span></dt><dt><span class="section"><a href="#id2452233">EPP příkazy</a></span></dt><dt><span class="section"><a href="#id2452274">Typy paramerů příkazu</a></span></dt><dt><span class="section"><a href="#id2499387">Společný parametr cltrid (Client transaction ID)</a></span></dt><dt><span class="section"><a href="#null_or_empty">Žádná hodnota / Prázdná hodnota</a></span></dt><dd><dl><dt><span class="section"><a href="#id2499439">Žádná hodnota: NULL</a></span></dt><dt><span class="section"><a href="#id2499565">Prázdná hodnota: '', ""</a></span></dt></dl></dd><dt><span class="section"><a href="#id2499643">Příkazy relace (session)</a></span></dt><dt><span class="section"><a href="#id2499838">Testovací příkazy</a></span></dt></dl></dd><dt><span class="chapter"><a href="#id2499989">5. 
    Skripty fred_create.py a fred_sender.py
    </a></span></dt><dt><span class="chapter"><a href="#output_types">6. Integrace klienta do PHP kódu</a></span></dt><dt><span class="chapter"><a href="#id2500336">7. 
    Knihovna fred a popis API
    </a></span></dt><dd><dl><dt><span class="section"><a href="#id2500353">Online dokumentace:</a></span></dt><dt><span class="section"><a href="#id2500408">Příklady práce s knihovnou</a></span></dt></dl></dd></dl></div><div class="preface" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title"><a id="id2489580"></a>Co je FredClient:</h2></div></div></div><p>
    FredClient je sada scriptů v jazyce Python postavených na fred knihovně
    a určených ke komunikaci s EPP serverem.
    </p><p>Sada obsahuje EPP konzoli a skripty určené pro použití v shellu.</p></div><div class="chapter" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title"><a id="id2489600"></a>Kapitola 1. Licence</h2></div></div></div><p>Licence je v souboru fred/LICENSE.</p></div><div class="chapter" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title"><a id="id2489609"></a>Kapitola 2. Požadavky na systém a instalace</h2></div></div></div><p>Pokyny k instalaci jsou v souboru INSTALL.</p></div><div class="chapter" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title"><a id="id2489620"></a>Kapitola 3. 
    Popis jednotlivých programů,
       parametry a config
    </h2></div></div></div><div class="toc"><p><b>Obsah</b></p><dl><dt><span class="section"><a href="#id2451655">
    Parametry (OPTIONS)
    </a></span></dt><dt><span class="section"><a href="#id2451707">
    Konfigurační soubor
    </a></span></dt></dl></div><p>
Dostupné skripty jsou následující:
</p><table class="simplelist" border="0" summary="Simple list"><tr><td>fred_client.py   - spouští EPP konzoli nebo sekvenci crate+send (pro shell)</td></tr><tr><td>fred_console.py  - EPP konzole, komunikuje s EPP serverem</td></tr><tr><td>fred_create.py   - Vytboří zdrojový EPP XML příkaz</td></tr><tr><td>fred_sender.py   - Odešle soubor na EPP server</td></tr></table><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2451655"></a>
    Parametry (OPTIONS)
    </h2></div></div></div><p>
Skripty se dají spouštět s parametry. Jaké parametry lze použít zjistíte 
zadáním parametru --help nebo -?:
</p><pre class="programlisting">
    $ fred_client.py --help
    $ fred_client.py -?

Použití: fred_console [parametry...]

Hlavní parametry:
  -?, --help       Zobrazit tuto nápovědu a skončit
  -V, --version    Zobrazit verzi programu a skončit
  -l LANGUAGE, --lang=LANGUAGE
                   Nastavení jazykové verze
  -v LEVEL, --verbose=LEVEL
                   Nastavení módu výpisu
                   1 - normální výstup
                   2 - zobrazit více detailů
                   3 - zobrazit více detailů a XML zdroje
  -x, --no_validate
                   Deaktivovat XML validaci na straně klienta

Parametry pro spojení:
  -f CONFIG, --config=CONFIG
                   Načtení konfigurace ze souboru
  -s SESSION, --session=SESSION
                   Použít session z konfiguračního souboru

  -h HOSTNAME, --host=HOSTNAME
                   Fred server host
  -p PORT, --port=PORT\n"
                   Server port (default: 700)
  -u USERNAME, --user=USERNAME
                   Přihlásit se jako uživatel
  -w PASSWORD, --password=PASSWORD
                   Přihlásit se s heslem
  -c CERTIFICATE --cert=CERTIFICATE
                   Pro spojení použít SSL certifikát
  -k PRIVATEKEY --privkey=PRIVATEKEY
                   Pro spojení použít SSL privátní klíč

  -n, --nologin
                   Deaktivovat automatické spojení se serverem po startu
  -d COMMAND, --command=COMMAND
                   Odeslat příkaz na server a skončit
  -o OUTPUT_TYPE, --output=OUTPUT_TYPE
                   Zobrazit výstup jako text (default), html, php
</pre></div><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2451707"></a>
    Konfigurační soubor
    </h2></div></div></div><p>
Konfigurační soubor se implicitně hledá nejdříve v home uživatele (~/.fred_client.conf), 
který skript spustil. Pokud tam není nalezen, hledá se v adresáři etc
(/etc/fred_client.conf). Na POSIX systémech je to /etc, v MS Windows 
to je v adresáři nastaveném v proměnné $ALLUSERSPROFILE.

Přepínačem --config=filepath (nebo -f filepath) je možné konfigurační soubor 
načíst z libovolného souboru.
</p><p>
Pro založení nového konfiguračního souboru je k dispozici příklad 
<span class="emphasis"><em>config_example.txt</em></span>. Tento příklad můžete použít jako základ pro váš
konfigurační soubor.
</p><p>
V konfiguračním souboru se nachází sekce connect, kde jsou uloženy cesty k certifikátům
a informace o serveru. Také tam jsou další hodnoty například username a password.
Pokud se tyto hodnoty v konfiguračním souboru nacházejí, tak je příkaz 
<span class="emphasis"><em>login</em></span> použije jako parametry příkazu, které mu nebyly zadány.
</p><p>
Zde je příklad konfigu:

</p><pre class="programlisting">
# Example of configuration file.
# Modify line with schema and dir=... set real path of your files.
# and save into /etc/fred_client.conf or ~/.fred_client.conf
#

[connect]
dir=/home/username/certificates
host = epp-test.ccreg.nic.cz
port = 700
ssl_cert = %(dir)s/certificate.pem
ssl_key  = %(dir)s/private_key.pem
username = MYUSERNAME
password = MYPASSWORD
timeout = 10.0      # socket timeout in sec.
# socket = IPv6     # Force socket type. Valid values are: IPv4 and IPv6. 
                    # othervice used type from offer of the server
# nologin = y       # turn off automatic login process after start up

[session]
schema = $python-site-packages/fred/schemas/all-1.0.xsd
poll_autoack = off           # send "poll ack" right after to "poll req"
confirm_send_commands = on   # confirm all editable commands
validate = on                # enable/disable xmllint
colors = yes                 # display colors on tty console
verbose = 2                  # set verbose level 1,2,3
# lang = en                  # if lang is not set, ti used value from os.environ.LANG
# null_value = None          # substitution of NULL value
# auto_login = off           # disable automatic login after start client (default is ON)
</pre><p>

Sekcí <span class="emphasis"><em>connect</em></span> může být více. Která z nich se při startu použije se nastaví
pomocí parametru <span class="emphasis"><em>-s --session</em></span>. Například si vytvoříte sekci [connect_myeppserver]
tu pak aktivujete: 

</p><pre class="programlisting">
    $ fred_client.py --session=myeppserver     (nebo -s myeppserver)

    [connect_myeppserver]
    dir=/test/certificates
    host = myeppserver.cz
    ssl_cert = %(dir)s/cert.pem
    ssl_key  = %(dir)s/key.pem
    username = myusername
    password = mypassword
</pre><p>
</p><p>
V sekci <span class="emphasis"><em>session</em></span> jsou tato nastavení:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>poll_ack</strong></span> = on/off </p><p>
        Při <span class="emphasis"><em>on</em></span> se po odeslání příkazu <span class="emphasis"><em>poll req</em></span> automaticky
        pošle i <span class="emphasis"><em>poll ack</em></span>.
    </p></li><li><p>
    <span class="bold"><strong>confirm_send_commands</strong></span> = on/off
    </p><p>
        Všechny editační příkazy (create, delete, update, ...) vyžadují v konzoli
        pozvrzení před odesláním na server. Tuto funkci lze vypnout/zapnout.
    </p></li><li><p><span class="bold"><strong>validate</strong></span> = on/off</p><p>
        K validaci se používá externí program xmllint. Validaci lze vypnout
        a dokumnety se tak na server posílají bez ověření platnosti formátu.
    </p></li><li><p><span class="bold"><strong>schema</strong></span> = /installdir/schemas/all-1.0.xsd</p><p>
        Soubor, ve kterém má validátor hledat schemata, podle kterých dokumenty ověřuje.
    </p></li><li><p><span class="bold"><strong>colors</strong></span> = on/off</p><p>
        Výstup na terminál může být barevný, pokud to terminál umožňuje.
    </p></li><li><p><span class="bold"><strong>verbose</strong></span> = 1/2/3</p><p>
        Úroveň výpisu 1 - stručná, 2 - celá, 3 - celá + XML zdrojové dokumenty.
    </p></li><li><p><span class="bold"><strong>lang</strong></span> = en/cs</p><p>
        Jazyková verze. Pokud není zadána žádná hodnota, tak se bere nastavení
        z proměnné LANG prostředí OS. Dostupné jsou zatím jen angličtina a čeština.
        Jazykovou verzi můžete také nastavit i pomocí parametru při spuštění skriptu.
    </p></li><li><p><span class="bold"><a id="config_null_value"></a><strong>null_value</strong></span> = NULL</p><p>
        Nastavení zástupce pro hodnotu nic (Nil), která vyjadřuje „<span class="quote">žádnou hodnotu</span>“.
        Defaultně je nastaveno NULL.
        Tuto hodnotu používáme, když chceme přeskočit některý z parametrů příkazu.
        Zadání NULL znamená, že jsme nezadali žádnou hodnotu na rozdíl od '' nebo "",
        kdy jsme zadali hodnotu nulové délky.
    </p><p>
        <span class="bold"><strong>Formát hodnoty NULL:</strong></span>
        Zástupce může být libovolný, ale nesmí obsahovat <span class="emphasis"><em>spojovník</em></span> (-), <span class="emphasis"><em>mezery</em></span> a 
        <span class="emphasis"><em>kulaté závorky</em></span>.
    </p><p>
        Více se o této hodnotě dozvíte v části 
        „<span class="quote"><a href="#null_or_empty" title="Žádná hodnota / Prázdná hodnota">Žádná hodnota / Prázdná hodnota</a></span>“
    </p></li></ul></div><p>V sekci <span class="emphasis"><em>connect</em></span> jsou tato nastavení:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>dir</strong></span> = cesta k adresáři s certifikáty</p><p>Tato hodnota nahrazuje zástupce <span class="emphasis"><em>%(dir)s</em></span> ve všech
    položkách dané sekce. V našem případě je v ní uložena cesta k certifikátům.
    </p></li><li><p><span class="bold"><strong>ssl_cert</strong></span> = jméno certifikátu</p><p>Název souboru s certifikátem. Před ním je uveden zástupce adresáře <span class="emphasis"><em>dir</em></span>,
    který je nahrazen hodnotou definovanou v této sekci.
    </p></li><li><p><span class="bold"><strong>ssl_key</strong></span> = jméno privátního klíče</p><p>Název souboru s privátním klíčem. Před ním je uveden zástupce adresáře <span class="emphasis"><em>dir</em></span>,
    který je nahrazen hodnotou definovanou v této sekci.
    </p></li><li><p><span class="bold"><strong>host</strong></span> = jméno_serveru</p><p>Název serveru, ke kterému se má klient připojit.
    </p></li><li><p><span class="bold"><strong>port</strong></span> = číslo_portu</p><p>Číslo portu serveru. Pokud není zadán, použije se default 700.
    </p></li><li><p><span class="bold"><strong>username</strong></span> = uživatelské jméno</p><p>Uživatelské jméno potřebné k přihlášení do systému.
    </p></li><li><p><span class="bold"><strong>password</strong></span> = heslo</p><p>Heslo potřebné k přihlášení do systému.
    </p></li><li><p><span class="bold"><strong>timeout</strong></span> = čas čekání na odpověď ve vteřinách</p><p>Nastavení timeoutu říká socketu jak dlouho má čekat na odpověď ze serveru.
    Pokud do uvedené doby odpověď nepřijde, je spojení považováno za přerušené.
    Defaultně je nastaveno 10 vteřin. <span class="bold"><strong>Pozor!</strong></span> V MS Windows se může u timeoutu vyskytnout bug,
    který způsobí, že se spojení nenaváže. V takovém případě nastavte timeout na nulu: timeout = 0
    </p></li><li><p><span class="bold"><strong>socket</strong></span> = IPv4/IPv6</p><p>
        Nastavení typu soketu na IPv4 nebo IPv6. Pokud není tato hodnota zadána,
        tak se použije typ soketu, který nabízí server.
    </p></li><li><p><span class="bold"><strong>nologin</strong></span> = on/off</p><p>
        Klient se ihned po spuštění pokusí spojit se serverem a zalogovat se.
        Tuto funkci je možné vypnout nastavením nologin = <span class="bold"><strong>off</strong></span>.
    </p></li></ul></div></div></div><div class="chapter" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title"><a id="id2452157"></a>Kapitola 4. 
    Program fred_console.py
    </h2></div></div></div><div class="toc"><p><b>Obsah</b></p><dl><dt><span class="section"><a href="#id2452190">Zobrazení helpu</a></span></dt><dt><span class="section"><a href="#id2452233">EPP příkazy</a></span></dt><dt><span class="section"><a href="#id2452274">Typy paramerů příkazu</a></span></dt><dt><span class="section"><a href="#id2499387">Společný parametr cltrid (Client transaction ID)</a></span></dt><dt><span class="section"><a href="#null_or_empty">Žádná hodnota / Prázdná hodnota</a></span></dt><dd><dl><dt><span class="section"><a href="#id2499439">Žádná hodnota: NULL</a></span></dt><dt><span class="section"><a href="#id2499565">Prázdná hodnota: '', ""</a></span></dt></dl></dd><dt><span class="section"><a href="#id2499643">Příkazy relace (session)</a></span></dt><dt><span class="section"><a href="#id2499838">Testovací příkazy</a></span></dt></dl></div><p>
fred_console.py je konzole, která komunikuje s EPP serverem. Konzoli spustíte
příkazem:
</p><pre class="programlisting">
    $ fred_console.py
</pre><p>
Pokud máte v configu správně nadefinovánu cestu k certifikátům a uložené login a heslo, 
tak můžete jednoduše zadat <span class="emphasis"><em>login</em></span> a tím se spojíte s EPP serverem.
Konzole se ukončuje příkazem "quit" nebo jen krátce "q".
</p><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2452190"></a>Zobrazení helpu</h2></div></div></div><p>
Jaké příkazy máte k dispozici zjistíte zadáním příkazu "help" (nebo h, ?).
</p><pre class="programlisting">
    FredClient verze 1.0.0 Zadejte "help", "license" nebo "credits" pro zobrazení více informací.
    &gt; help
</pre><p>Help vypíše dvě části nápovědy:</p><table class="simplelist" border="0" summary="Simple list"><tr><td>1) Dostupné EPP příkazy</td></tr><tr><td>2) Příkazy relace (session) pro nastavení vnitřních proměnných 
       konzole</td></tr></table></div><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2452233"></a>EPP příkazy</h2></div></div></div><p>
EPP příkaz zadáváte společně s jeho parametry. Jaké parametry příkaz
požaduje zjistíte, když zadáte "help příkaz" nebo zkráceně "h příkaz"
nebo také "? příkaz".
</p><p>Například:</p><pre class="programlisting">&gt; ?login</pre><p>
Vypíšou se podrobnosti o jednotlivých parametrech daného příkazu. 
Samotný příkaz zadáte tak, že napíšete název příkazu a za ním jeho parametry:
</p><pre class="programlisting">&gt; login username password</pre></div><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2452274"></a>Typy paramerů příkazu</h2></div></div></div><p><span class="emphasis"><em>INSTRUKCE:</em></span></p><table class="simplelist" border="0" summary="Simple list"><tr><td>parametry zadávejte v pořadí, v jakém jsou vypsané v helpu</td></tr><tr><td>hodnoty s mezerami dejte do uvozovek</td></tr><tr><td>seznamy se definují pomocí závorek, položky seznamu můžou 
      (ale nemusí) být odděleny čárkami</td></tr><tr><td>pokud je v seznamu jen jedna položka, nemusí se závorky zadávat</td></tr><tr><td>jmenné prostory se také jako seznamy definují pomocí závorek</td></tr><tr><td>chcete-li seznam nebo jmenný porostor vynechat, zadejte jen
      prázdné závorky</td></tr><tr><td>Hodnotu, kterou chcete přeskočit zadejte jako „<span class="quote">žádnou hodnotu</span>“ (<a href="#null_or_empty" title="Žádná hodnota / Prázdná hodnota">Žádná hodnota / Prázdná hodnota</a>).</td></tr><tr><td>hodnoty mimo pořadí zadávejte pomocí klíče</td></tr></table><p><span class="emphasis"><em>VYSVĚTLENÍ:</em></span></p><table class="simplelist" border="0" summary="Simple list"><tr><td>jednoduchá hodnota:  my-value01</td></tr><tr><td>hodnota s mezerou:   'lorem ipsum'   "some value"</td></tr><tr><td>seznam:              (one two three)</td></tr><tr><td>jmenný prostor:      ((one two three) my-value01 'lorem ipsum' (enyky benyky) end-value)</td></tr></table><p>
Pokud hodnota parametru obsahuje mezeru, tak ji napište do uvozovek. 
Například:

    </p><pre class="programlisting">&gt; login username "moje heslo s mezerami"</pre><p>

Některé parametry můžou obsahovat seznam hodnot. Například parametr 
"street" v příkazu create_contact.
Výpis části helpu:

    </p><pre class="programlisting">
    ?create_contact
    ...
    ... street                   Ulice (seznam o maximálně 3 položkách.)
    ...
    </pre><p>

Seznam zadáte tak, že hodnoty uzavřete do závorek:

    </p><pre class="programlisting">&gt; create_contact CID:MYID ... (Vodičkova, "Na příkopě", "U přívozu") ...
    </pre><p>

Pokud zadáváte jen jednu hodnotu ze seznamu, tak závorky zadávat
nemusíte:

    </p><pre class="programlisting">
    &gt; create_contact CID:MYID ... Vodičkova ...
    </pre><p>

Parametry musíte zadávat v pořadí, v jakém jsou v helpu vypsány. Povinné
jsou vždy na začátku a nepovinné tak není nutné zadávat. Pokud byste kromě
povinných hodnot chtěli zadat i nějakou nepovinnou, tak byste museli nejprve zadat 
všechny hodnoty předcházející té, kterou chcete zadat. Pro tento případ
umožňuje klient zadat hodnotu pomocí pojmenovaného parametru - klíče.
Řeší se tím tak situace, kdy chcete například zadat jen jeden údaj, který je
ještě k tomu někde na konci seznamu parametrů.
</p><p>
Klíč (jméno parametru) se definuje pomocí jedné nebo dvou pomlček, přesněji 
řečeno spojovníků. Například chcete v příkazu create_contact zadat kromě 
povinných údajů už jen hodnotu notify_email (Oznámení na email), která se 
nachází právě na úplném konci seznamu parametrů. Pak tuto hodnotu zadáte takto:

  </p><pre class="programlisting">
  &gt; create_contact CID:ID myname my@mail.com city cc --notify_email = muj@mail.cz
  </pre><p>

Jaký má být klíč (název parametru) zjistíte z helpu daného příkazu.
Parametr s klíčem pak již nemusí být na "své" pozici, ale může být
kdekoliv v řadě mezi ostatními parametry. Takový parametr stojí "mimo"
pořadí a nenarušuje pozice ostatních parametrů bez klíče. Zde jsou 
do řady parametrů vloženy hodnoty s klíči "vat" a "notify_email":

    </p><pre class="programlisting">
    &gt; create_contact CID:ID myname my@mail.com --vat = 12346 --notify_email = muj@mail.cz city cc
    </pre><p>

Některé příkazy mají parametry vnořené do dalších parametrů. Ty vytvářejí
tak zvané jmenné prostory. Například v příkazu "create_contact" je parametr 
"disclose". Ten obsahuje další parametry "flag", "data". Samotný
název "disclose" není v tomto případě název klíče, ale název jmenného
prostoru, ve kterém se nacházejí klíče "flag" a "data". Jmenné
prostory se definují stejně jako seznamy pomocí závorek:

  </p><pre class="programlisting">
  &gt; create_contact my-ID my-name mail city cc org street sp pc 
        voice fax (n (name org addr voice fax email)) vat ssn
  </pre><p>

Pokud jmenný prostor nechcete zadávat, napište prostě jen prázdné
závorky. To platí i pro seznamy:

  </p><pre class="programlisting">
  &gt; create_contact CID:ID myname my@mail.com City CC Organisation Street SP PC Voice Fax () Vat Ssn notify@email.com
  </pre><p>

Některé příkazy mají v parametrech seznamy jmenných prostorů. V takovém
případě pak závorky mají své významy podle toho, jak jsou hodnoty
seskupeny. Například příkaz "update_nsset" má jeden 
nepovinný parametr "add" (Přidat hodnoty). Pokud jej nechcete zadávat, tak napíšete:

  </p><pre class="programlisting">
  &gt; update_nsset id () ...    - parametr add je nyní prázdný
  </pre><p>

Pokud ale "add" zadat chcete, tak "add" (jak vidíte v helpu) obsahuje
seznam devíti jmenných prostorů "dns"! Každý "dns" prostor pak dále
obsahuje parametr "name" a seznam "addr". Pokud chete tyto hodnoty zadat, 
tak musíte zapsat všechny závorky, které jsou nutné: První závorka pro definování 
jmenného prostoru "add". Druhá závorka pro začátek seznamu jmenných prostorů "dns".
Třetí závorka pro samotný jmenný prostor "dns". Teprve pak následuje
hodnota parametru "name". Za ním pak následuje závorka seznamu "addr":

  </p><pre class="programlisting">
  &gt;  update_nsset NSSID:nsset1 (((ns1.dns.cz (217.31.207.130, 217.31.207.131, 217.31.207.132)), 
        (ns2.dns.cz (217.31.207.130, 217.31.207.131, 217.31.207.132))) (tech1, tech2, tech3) 
        (ok, clientTransferProhibited)) (((rem1.dns.cz, rem2.dns.cz) (CID:rem01, CID:rem02) 
            serverUpdateProhibited)) (password)
  </pre><p>

Pokud "addr" není seznam, ale jen jedna hodnota, tak se závorky pro
"addr" zadávat nemusí:
(To je pravidlo již zmíněné v předchozím textu.)

  </p><pre class="programlisting">
  &gt; update_nsset nsset-ID (((ns1.dns.cz 217.31.207.130),(ns2.dns.cz 217.31.207.130))
        tech status) ...
  </pre><p>

Takto složité zadávání naštěstí existuje jen v malém množství příkazů a
tento uvedený příklad zadání je vůbec nejsložitější ze všech. Kromě
toho máte možnost zadávat parametry příkazu v interaktivním módu. Ten umožňuje zadávat
parametry postupně - klient vyzve k zadání parametru a uživatel je vyplňuje
jeden za druhým. Na konci helpu u každého příkazu je uveden
příklad zadání všech parametrů. 
</p><p>
<span class="bold"><strong>Interaktivní mód</strong></span> vkládání parametrů se spouští pomocí vykřičníku, který
se napíše před příkaz:

  </p><pre class="programlisting">&gt; !update_nsset</pre><p>

Tím spustíte režim interaktivního vkládání parametrů. Konzole vždy
vypíše jméno parametru a čeká na zadání hodnoty. Pokud hodnotu nechcete
zadat, tak prostě stisknete enter a hodnota se přeskočí. Interaktivní
režim můžete kdykoliv zrušit stisknutím kláves Ctrl+C (C jako Cancel). 
Po zadání všech povinných parametrů, kdy už nechcete zadávat další nepovinné
hodnoty, lze interaktivní režim dokončit stiknutím kláves Ctrl+D (D jako Done nebo Dokončit).

V případě zrušení interaktivního módu se žádný příkaz nesestaví a nic se
na server neposílá. V případě dokončení módu se sestaví příkaz 
a na konzoli se vypíše tak, jako byste jej zadali přímo bez interaktivního režimu.
Pak se příkaz odešle na server. V případě, že se jedná o „<span class="quote">editační</span>“ příkaz
a je zapnutá funkce potvrzování (confirm), tak se příkaz musí před odesláním
na server ještě potvrdit:

    </p><pre class="programlisting">
REG-LRR@epp-test.ccreg.nic.cz&gt; !update_nsset
Start interaktivního módu. Mód zrušíte stisknutím Ctrl+C. Příkaz dokončíte kombinací Ctrl+D.
NSSET ID [povinný]: nssid:id01
Přidat hodnoty / Seznam DNS[1/9] / Jmenný server [povinný jen je-li tato část zadána]: ns1.dns.cz
Přidat hodnoty / Seznam DNS[1/9] / Adresa serveru[1/oo] [nepovinný]: 217.31.207.130
Přidat hodnoty / Seznam DNS[1/9] / Adresa serveru[2/oo] [nepovinný]: 217.31.207.131
Přidat hodnoty / Seznam DNS[1/9] / Adresa serveru[3/oo] [nepovinný]:
Přidat hodnoty / Seznam DNS[2/9] / Jmenný server [nepovinný]:
Přidat hodnoty / Technický kontakt ID[1/oo] [nepovinný]: cid:myid01
Přidat hodnoty / Technický kontakt ID[2/oo] [nepovinný]:
Přidat hodnoty / Stav[1/6] [nepovinný]:
Interaktivní mód ukončen. [stiskněte Enter]
Příkaz k odeslání:
update_nsset nssid:id01 (((ns1.dns.cz (217.31.207.130, 217.31.207.131))) cid:myid01)
Opravdu chcete odeslat tento poříkaz na server? (y/N): y
nssid:id01 aktualizováno.
REG-LRR@epp-test.ccreg.nic.cz&gt;
    </pre><p>

Ještě jednou zpět k zadávání pomocí klíče: Klíč se zadává ve tvaru 
-[název parametru] [hodnota].
Například:

</p><pre class="programlisting">
     -heslo "toto je moje heslo"
</pre><p>

Toto zadání lze napsat i takto se stejným účinkem:

</p><pre class="programlisting">
     --heslo = "toto je moje heslo"
</pre><p>

Záleží na vás, který zápis se vám bude zdát čitelnější. Jak ale zadat
honodotu, která je součástí jmenného prostoru? Jednoduše pomocí tečkové
koncence:

</p><pre class="programlisting">
    --add.dns.name = nsset_name
</pre><p>

Takto jste definovali hodnotu nsset_name do jmenného porostoru "add", 
do první položky seznamu "dns", do parametru "name". Chcete-li uložit
hodnotu například do třetí položky seznamu "dns", tak zadejte:

</p><pre class="programlisting">
    --add.dns[2].name = nsset_name
</pre><p>

Dvojka je index seznamu v tomto případě o max. devíti položkách
(indexy 0 - 8).
</p></div><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2499387"></a>Společný parametr cltrid (Client transaction ID)</h2></div></div></div><p>
Každý EPP příkaz, kromě příkazu <span class="emphasis"><em>hello</em></span>, obsahuje 
tag <span class="bold"><strong>&lt;clTRID&gt;</strong></span>. Ten je vždy jako
poslední z parametrů a jmenuje se <span class="bold"><strong>cltrid</strong></span>.
Tato hodnota je identifikátor transakce. Ten si stanovuje klient a 
může být libovolný v rámci formátovacích pravidel definovaných ve
schematech pro tuto hodnotu. Identifikátor je nepovinný a pokud 
není zadán, tak jej klient automaticky doplní.
</p></div><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="null_or_empty"></a>Žádná hodnota / Prázdná hodnota</h2></div></div></div><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h3 class="title"><a id="id2499439"></a>Žádná hodnota: NULL</h3></div></div></div><p>
Výraz <span class="emphasis"><em>Žádná hodnota</em></span> představuje hodnotu, kterou 
jste nezadali. Slouží nám k tomu, abychom mohli přeskakovat parametry,
které nechceme zadávat. Defaultě je výraz nastaven na NULL.
</p><p>
Například, když v příkazu <span class="emphasis"><em>create_contact</em></span> 
chtece kromě povinných parametrů uvést už jen telefonní číslo 
(parametr <span class="emphasis"><em>voice</em></span>). Mezi posledním povinným parametrem
<span class="emphasis"><em>pw</em></span> a pořadovaným <span class="emphasis"><em>voice</em></span> leží ještě další čtyři parametry:
<span class="emphasis"><em>org, street, sp, cp</em></span>. Místo nich zadáte "žádnou hodnotu" 
- pokud jste nenastavili jinak, tak NULL. 
Tím jste telefonní číslo umístili na správnou pozici v parametrech příkazu:

</p><pre class="programlisting">
   create_contact CID:ID01 'Jan Novak' info@mymail.cz Praha CZ mypassword NULL NULL NULL NULL +420.222745111
</pre><p>

Uvedený příkaz <span class="bold"><strong>nebude</strong></span> v XML struktuře vytvářet tagy pro hodnoty
<span class="emphasis"><em>org, street, sp, cp</em></span>:

</p><pre class="programlisting">
&lt;contact:id&gt;CID:ID01&lt;/contact:id&gt;
        &lt;contact:postalInfo&gt;
          &lt;contact:name&gt;Jan Novak&lt;/contact:name&gt;
          &lt;contact:addr&gt;
            &lt;contact:city&gt;Praha&lt;/contact:city&gt;
            &lt;contact:cc&gt;CZ&lt;/contact:cc&gt;
          &lt;/contact:addr&gt;
        &lt;/contact:postalInfo&gt;
        &lt;contact:voice&gt;+420.222745111&lt;/contact:voice&gt;
</pre><p>


</p><p>
V <span class="emphasis"><em>interaktivním módu</em></span> zadávání parametrů zadáte „<span class="quote">žádnou hodnotu</span>“ 
prostě tak, že jenom stisknete ENTER.
</p><p>
Definici <span class="emphasis"><em>žádné hodnoty</em></span> lze v konzoli změnit příkazem 
<a href="#null_value">null_value</a>
a také je možné si ji definovat v <a href="#config_null_value">konfiguračním souboru</a>.
</p></div><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h3 class="title"><a id="id2499565"></a>Prázdná hodnota: '', ""</h3></div></div></div><p>
Výraz <span class="emphasis"><em>Prázdná hodnota</em></span> představuje hodnotu, která je prázdná.
Je to tedy text o nulové délce. Ten zapisujeme práznými uvozovkami '' nebo "".
Tato hodnota nám slouží k tomu, abychom mohli zadávat hodnoty nulové délky.
Rozdíl mezi práznou hodnotou a žádnou je v tom, že tato hodnota generuje tag v XML
dokumentu. Protože je prázdná, tak daný XML tag bude také prázdný.

</p><pre class="programlisting">
   create_contact CID:ID01 'Jan Novak' info@mymail.cz Praha CZ mypassword '' '' '' '' +420.222745111
</pre><p>

Příkaz vygeneruje XML, ve kterém budou u prázdných hodnot prázdné tagy:

</p><pre class="programlisting">
&lt;contact:id&gt;CID:ID01&lt;/contact:id&gt;
        &lt;contact:postalInfo&gt;
          &lt;contact:name&gt;Jan Novak&lt;/contact:name&gt;
          <span class="bold"><strong>&lt;contact:org/&gt;
          &lt;contact:addr&gt;
            &lt;contact:street/&gt;</strong></span>
            &lt;contact:city&gt;Praha&lt;/contact:city&gt;
           <span class="bold"><strong>&lt;contact:sp/&gt;
            &lt;contact:pc/&gt;</strong></span>
            &lt;contact:cc&gt;CZ&lt;/contact:cc&gt;
          &lt;/contact:addr&gt;
        &lt;/contact:postalInfo&gt;
        &lt;contact:voice&gt;+420.222745111&lt;/contact:voice&gt;
</pre><p>

</p><p>
V <span class="emphasis"><em>interaktivním módu</em></span> zadávání parametru zadáme „<span class="quote">prázdnou hodnotu</span>“ tak,
že zapíšeme prázdné uvozovky '' nebo "".
</p></div></div><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2499643"></a>Příkazy relace (session)</h2></div></div></div><p>
Konzole má svá vnitřní nastavení, která můžete nastavit. Pokud zadáte
příkaz bez parametrů, tak se pouze vypíše aktuální stav nastavení.

</p><pre class="programlisting">
&gt; ! epp_příkaz
</pre><p>

Tímto příkazem se spouští interaktivní mód zadávání parametrů. Mód funguje jen pro EPP příkazy.
Vkládání se ukončí automaticky po zadání všech parametrů nebo jej lze ukončit stisknutím
kombinace kláves Ctrl+D (Done) nebo zrušit Ctrl+C (Cancel).

</p><pre class="programlisting">
&gt; poll_autoack [on/off]
</pre><p>

Pokud je tento přepínač ON, tak se po odeslání příkazu "poll req" automaticky odesílá i "poll ack".
Tuhle funkci asi nejvíce oceníte, když budete mít na serveru hodně zpráv. Příkaz "poll req" zprávu
ze serveru pouze zobrazí, ale pak se zpráva musí ze serveru odstranint příkazem "poll ack ID-zprávy".
Při automatickém poll-ack se bude odstraňování provádět automaticky po zobrazení zprávy.

</p><pre class="programlisting">
&gt; confirm [on/off]
</pre><p>

U EPP editačních příkazů, které nějak mění hodnoty na serveru (create, upadte, delete, transfer, renew),
se před odesláním požaduje potvrzení k odeslání. Přepínačem "confirm OFF" lze toto potvrzování vypnout.


</p><pre class="programlisting">
&gt; credits
</pre><p>

Příkaz credits zobrazí text s informacemi o klientovi.

</p><pre class="programlisting">
&gt; help [příkaz]
</pre><p>

Příkaz help zadaný bez parametru zobrazí seznam dostupných příkazů. Pokud se zadá i parametr
příkaz, tak se zobrazí detaily zadaného příkazu. Stejný význam jako "help" mají i příkazy
"h" a "?".

</p><pre class="programlisting">
&gt; lang [kód]
</pre><p>

Příkazem lang se přepíná jazyková verze klienta a serveru. Pokud jste ale již zalogováni, tak
je nutné se odlogovat a znovu zalogovat. Důvod je ten, že typ jazykové verze se serveru sděluje
pouze pomocí příkazu "login". To je také druhá možnost, jak přepnout na jinou jazykovou verzi:

„<span class="quote"><span class="bold"><strong>login usename password cs</strong></span></span>“

V této verzi klienta i serveru jsou dostupné jen dva jazyky: en - angličtina; cs - čeština.

</p><pre class="programlisting">
&gt; license
</pre><p>

Příkaz license zobrazí text licence klienta.

</p><pre class="programlisting">
&gt; quit
</pre><p>

Příkaz quit odpojí klienta od serveru a ukončí aplikaci. Synonyma 'q' a 'exit' mají 
stejnou funkci.

</p><pre class="programlisting">
&gt; validate [on/off]
</pre><p>

Tímto přepínačem zapnete nebo vypnete proces validace XML dokumentu. Validace je v této verzi
realizována přes externí program <span class="emphasis"><em>xmllint</em></span>. Pokud není v systému přítomen, 
tak nastavení ON nemá žádný efekt. Validace ověřuje platnost XML dokumentu podle EPP schemat 
a to jak v odchozích, tak i příchozích zprávách. Pokud není dokument validní, tak jej 
konzole na server neodešle.
Nevalidní dokument vznikne například tím, že zadáte hodnotu, která neodpovídá konkrétnímu schématu.
Například příliš krátké heslo. Konzole v této verzi obsah hodnot nijak neověřuje, pouze zjišťuje
jestli byly zadány nebo ne.

</p><pre class="programlisting">
&gt; verbose [úrověň]
</pre><p>

Klient zobrazuje různé informace. Ty jsou rozděleny do úrovní detailů.
První úroveň zobrazování (základní) je určena pro běžného uživatele a
vypisuje nezbytné minimum informací, které jsou k práci nutné.
Pro zvídavé uživatele je zacílena druhá úroveň, která vypisuje všechna
dostupná hlášení, která se během komunikace vyskytla. Třetí úroveň zobrazuje
ještě navíc XML zdrojové dokumenty, které si klient se serverem předává.

</p><table class="simplelist" border="0" summary="Simple list"><tr><td><span class="emphasis"><em>Úrovně výpisu detailů:</em></span></td></tr><tr><td>1 - stručná (default)</td></tr><tr><td>2 - všechno</td></tr><tr><td>3 - všechno a XML zdroje.</td></tr></table><p>

</p></div><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2499838"></a>Testovací příkazy</h2></div></div></div><p>

Konzole má několik testovacích příkazů, které je možné použít k daným účelům.
Testovací příkazy se v helpu nezobrazují.

</p><pre class="programlisting">
&gt; raw-command [dict]
&gt; raw-answer [dict]
</pre><p>

Tento příkaz má podobnou funkci jako verbose úroveň 3. Příkaz vypisuje zdrojový XML
dokument posledního příkazu nebo odpovědi. Pokud tedy nemáte verbose úroveň právě nastavenu
a chcete se na zdrojový dokument podívat, tak právě k tomu je tento příkaz určen.
Místo "raw" lze zadat i "src" a oba příkazy fungují ve zkrácené verzi:

</p><pre class="programlisting">
    raw-c, raw-c d, src-c, src-c d, raw-a, raw-a d, src-a, src-a d
</pre><p>

Vysvětlení:
Každý příkaz, který zadáte v promptu se sestaví do XML EPP dokumentu. Pokud si chcete tento
XML dokument prohlédnout, tak zadáte "src-c" a na výstup se vypíše vygenerované zdojové XML. 
Chcete-li vidět XML zdojový dokument od serveru, zadejte "src-a".
Pokud je XML dokument nepřehledný a vy chcete vidět jasněji strukturu jednotlivých XML uzlů,
tak zadejte "src-c d" (nebo "src-a d"). Konzole vypíše hodnoty uzlů v přehlednější formě s odsazením.

</p><pre class="programlisting">
&gt; config
</pre><p>

Příkaz zobrazuje jméno a cestu použitého konfiguračního souboru a interní proměnné 
z něj načetené.

</p><pre class="programlisting">
&gt; send [filename]
</pre><p>

Send je ryzí testovací příkaz a slouží k posílání libovolného souboru na EPP server. 
Pokud jej zadáte bez parametrů, tak vypíše aktuální adresář. Když "send" zadáte se
jménem platného souboru, tak tento soubor odešle na EPP server:

</p><pre class="programlisting">
    send some-folder/my-test-file.xml
</pre><p>

</p><pre class="programlisting">
&gt; colors [on/off]
</pre><p>

Pokud to konzole umožňuje, tak tímto příkazem lze zapnout zvýraznění výtupu.
To je v některých hlášeních zapsáno tučně a barevně. Například chyby jsou červeně,
kladné vyřízení příkazu zeleně.

<a id="null_value"></a></p><pre class="programlisting">
&gt; null_value [nějaká_hodnota]
</pre><p>

Nastavení reprezentace „<span class="quote">žádné hodnoty</span>“. Viz <a href="#null_or_empty" title="Žádná hodnota / Prázdná hodnota">Žádná hodnota / Prázdná hodnota</a>
a <a href="#config_null_value">Formát hodnoty NULL</a>.

</p><pre class="programlisting">
&gt; output [typ_výstupu]
</pre><p>

Příkaz output není přímo testovací. Je určen k nastavení typu výstupu.
Platné honodty jsou text, php, html.
Podrobnější popis je na <a href="#output_types" title="Kapitola 6. Integrace klienta do PHP kódu">Integrace klienta do PHP kódu</a>

</p></div></div><div class="chapter" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title"><a id="id2499989"></a>Kapitola 5. 
    Skripty fred_create.py a fred_sender.py
    </h2></div></div></div><p>


Skripty <span class="emphasis"><em>fred_create.py</em></span> a <span class="emphasis"><em>fred_sender.py</em></span> jsou určeny pro použití v shell batchi.

<span class="emphasis"><em>fred_create.py</em></span> přijímá parametry se standardního vstupu a vygeneruje 
XML EPP dokument na standardní výstup. Například:
</p><pre class="programlisting">
    $ python fred_create.py info_domain nic.cz
    $ echo -en "check_domain nic.cz\ninfo_domain nic.cz" | ./fred_create.py
    $ cat file-with-commands.txt | ./fred_create.py
</pre><p>&lt;?xml version='1.0' encoding....</p><p>
Pokud nastane nějaká chyba, tak vrací XML s chybovým hlášením:
</p><pre class="programlisting">
    $ python fred_create.py inxo_domain nic.cz
</pre><p>
&lt;?xml encoding='utf-8'?&gt;&lt;errors&gt;inxo_domain nic.cz: Neznámý příkaz!&lt;/errors&gt;
</p><p>
<span class="emphasis"><em>fred_sender.py</em></span> odesílá dokumenty na server. Skript se automaticky zaloguje, pak
předá dokument, zobrazí odpověď a odloguje se a ukončí. Pro správné zalogovájní je nutné
mít správně nastaven konfigurační soubor.</p><p>
Skript může odesílat dokumenty dvěma způsoby:
</p><p>
    1. dokumenty se uloží do souboru a skriptu se předají jména souborů. Skript
       je pak odesílá v uvedeném pořadí. Například:
</p><pre class="programlisting">
    $ ./fred_create.py check_domain cosi.cz nic.cz &gt; doc1.xml
    $ ./fred_create.py info_domain nic.cz &gt; doc2.xml
    $ ./fred_sender.py doc1.xml doc2.xml
</pre><p>
</p><p>
    2. PIPE - Zřetězením příkazů create a sender.
       Například:

</p><pre class="programlisting">
    $ ./fred_create.py check_domain cosi.cz nic.cz | ./fred_sender.py
    $ echo -en "check_domain nic.cz\ninfo_domain nic.cz" | ./fred_create.py | ./fred_sender.py
</pre><p>
</p></div><div class="chapter" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title"><a id="output_types"></a>Kapitola 6. Integrace klienta do PHP kódu</h2></div></div></div><p>
Součástí distribuce klienta je i ukázkový PHP skript, který demonstruje,
jak lze klienta začlenit do PHP: <span class="bold"><strong>client_example.php</strong></span>.
V příkladu je nutné správně nastavit cestu ke klientovi <span class="emphasis"><em>$exec_path</em></span> (pokud ten nebyl nainstalován
standardním způsobem a systém jej nenalezne).
Proměnou <span class="emphasis"><em>$php_module_name</em></span> se nastavuje přesměrování do souboru a <span class="emphasis"><em>$command_options</em></span> umožňují
přidat další parametry, jsou-li třeba.
</p><p>Popis začlenění klienta:</p><p>
Klient <span class="emphasis"><em>fred_client.py</em></span> lze spustit i tak, že se mu v parametrech na příkazové řádce zadá příkaz,
který má vykonat <span class="emphasis"><em>-d --command</em></span>. V takovém případě se nespouští konzole, ale klient funguje jako batch.
Stejně jako kombinace skriptů fred_create.py a fred_sender.py. 
Klient pouze zadaný příkaz provede, zobrazí výstup a ukončí se. Přihlášení a odhlášení
(login, logout) proběhnou automaticky a na výstup se nevypisují. Pro správné přihlášení
je proto potřebné mít nastavený konfigurační soubor nebo vše definovat na příkazové řádce.
</p><p>
Přepínačem <span class="bold"><strong>--output -o</strong></span> upravíme výstup do požadovaného formátu. Pokud chceme v prohlížeči hodnoty pouze
zobrazit, můžeme zadat typ HTML: --output=html. Chceme-li data dále
zpracovávat PHP skriptem, nastavíme typ PHP: --output=php.
</p><p>Shrnutí metody použití klienta v PHP:</p><table class="simplelist" border="0" summary="Simple list"><tr><td>V PHP se klient spustí jako externí program například funkcí <span class="emphasis"><em>passthru()</em></span>.</td></tr><tr><td>V parametrech se nastaví mód výpisu na PHP: --outout=php</td></tr><tr><td>Výstup klienta se přesměruje do adresáře s právy zápisu: <span class="emphasis"><em>... &gt; /cache/outout.php</em></span></td></tr><tr><td>Výsledný kód se vloží do stránky <span class="emphasis"><em>required_once('/cache/outout.php')</em></span> a tím jsou hodnoty PHP skriptu dostupné.</td></tr></table><p>Proměnné z PHP výstupu</p><table class="simplelist" border="0" summary="Simple list"><tr><td>$fred_error_create_name = 'poll'; // jméno neplatného příkazu</td></tr><tr><td>$fred_error_create_value = 'op: Value "xxx" is not allowed. Valid is: (req, ack)'; // popis chyby, která se objevila při vytváření příkazu.</td></tr><tr><td>$fred_encoding = 'utf-8'; // kódování textu </td></tr><tr><td>$fred_code = 1000; // návratový kód odpovědi </td></tr><tr><td>$fred_command = 'domain:info'; // název odeslaného příkazu </td></tr><tr><td>$fred_reason = 'Command completed successfully'; // popis návratového kódu </td></tr><tr><td>$fred_errors = array(); // seznam chybových hlášek, které vznikly během komunikace se serverem </td></tr><tr><td>$fred_labels = array(); // seznam popisků hodnot </td></tr><tr><td>$fred_data = array(); // seznam hodnot </td></tr><tr><td>$fred_source_command = '...'; zdrojový XML dokument příkazu připravený pro zobrazení (projetý
funkcí htmlspecialchars(), generuje se jen ve verbose 3). </td></tr><tr><td>$fred_source_answer = '...'; zdrojový XML dokument odpovědi připravený pro zobrazení (projetý
funkcí htmlspecialchars(), generuje se jen ve verbose 3). </td></tr></table><p>Příklad dat:</p><pre class="programlisting">
$fred_labels['domain:name'] = 'Domain name';
$fred_data['domain:name'] = 'domena.cz';
$fred_labels['domain:roid'] = 'Repository object ID';
$fred_data['domain:roid'] = 'D0000000174-CZ';
$fred_labels['domain:crID'] = 'Created by';
$fred_data['domain:crID'] = 'REG-LRR';
$fred_labels['domain:clID'] = 'Designated registrar';
$fred_data['domain:clID'] = 'REG-LRR';
$fred_labels['domain:crDate'] = 'Created on';
$fred_data['domain:crDate'] = '2006-10-31T16:51:56+01:00';
$fred_labels['domain:exDate'] = 'Expiration date';
$fred_data['domain:exDate'] = '2009-10-31T01:00:00+01:00';
$fred_labels['domain:renew'] = 'Last renew on';
</pre></div><div class="chapter" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title"><a id="id2500336"></a>Kapitola 7. 
    Knihovna fred a popis API
    </h2></div></div></div><div class="toc"><p><b>Obsah</b></p><dl><dt><span class="section"><a href="#id2500353">Online dokumentace:</a></span></dt><dt><span class="section"><a href="#id2500408">Příklady práce s knihovnou</a></span></dt></dl></div><p>

Knihovna "fred" vám umoňuje implmentovat API rozhraní do vašich aplikací. Knihova i jednotlivé funkce
obsahují komentáře, podle kterých se můžete při implementaci řídit. V části __init__.py naleznete
i ukázky kódu.
</p><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2500353"></a>Online dokumentace:</h2></div></div></div><p>
Pokud si chcete projít jednotlivé třídy a funkce knihovny, tak k tomu můžete využít generátor
dokumentace, který je standardní součástí pythonu: Zadejte na příkazové řádce příkaz:

</p><pre class="programlisting">
    $ pydoc -p 8080
</pre><p>

Tím jste spustili webový server, který generuje strany dokumentace přímo ze zdrojových souborů.
Parametr -p udává na jakém portu je server spuštěn. Číslo portu můžete zadat jakékoliv jiné.
Nyní si otevřete prohlížeč a zadejte adresu: http://localhost:8080/. Otevře se strana, na které
v části ../site-packages naleznete odkaz na fred (package).
</p><p>
Pokud jste skripty neinstalovali, ale jen nakopírovali, nebo pokud se chcete podívat i na skripty
pracující s knihovnou fred, tak celý proces spuštění udělejte stejně, ale s tím rozdílem, že pydoc
spustíte z adresáře, kde máte tyto skripty uložené. Pak se v helpu zobrazí i ony:

</p><pre class="programlisting">
    $ cd FredClient-1.0.0
    $ pydoc -p 8080
</pre><p>

Server ukončíte stiskem Ctrl+C.
</p></div><div class="section" lang="cs" xml:lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2500408"></a>Příklady práce s knihovnou</h2></div></div></div><p>
Import knihovny provedete příkazem:

</p><pre class="programlisting">
    &gt;&gt;&gt; import fred
</pre><p>

Instanci EPP klienta vytvoříte:

</p><pre class="programlisting">
    &gt;&gt;&gt; epp = fred.Client()
</pre><p>

Ještě musíte načíst config, aby knihovna našla certifikát:

</p><pre class="programlisting">
    &gt;&gt;&gt; epp.load_config()
</pre><p>

Chcete-li načíst jinou session - analogicky k parametru --session, tak zadejte:

</p><pre class="programlisting">
    &gt;&gt;&gt; epp.load_config('my-sessison-name')
</pre><p>

Pak již můžete navázat spojení funkcí login:

</p><pre class="programlisting">
    &gt;&gt;&gt; retval = epp.login("username","password")
</pre><p>

Každá funkce (EPP příkazu) vrací tuto "retval" hodnotu, která je typu dict a ve tvaru:

</p><pre class="programlisting">
    {'reason': u'Text of answer reason', 
     'code': 1000,
     'command': 'command_name',  
     'errors': []
     'data': {'key': 'value' [,'next-key':'next-value']}, 
    }
</pre><p>

</p><table class="simplelist" border="0" summary="Simple list"><tr><td>Klíč "reason" (str) je vyrozumění serveru o stavu odpovědi.</td></tr><tr><td>Klíč "code" (int) je číslo, které definuje typ chyby. Číslo 1000 znamená OK - vše vpořádku.</td></tr><tr><td>Klíč "command" (str) je název příkazu, na který se odpověď vztahuje (který odpověď vyvolal).</td></tr><tr><td>Klíč "errors" (list) je seznam chyb, které server nalezl.</td></tr><tr><td>Klíč "data" (dict) je slovník s hodnotami individuálními pro každý jednotlivý příkaz.</td></tr></table><p>

Jaké klíče jsou v části "data" pro danou funkci (EPP příkaz) se dozvíte z dokumentace u každé funkce:

</p><pre class="programlisting">
    &gt;&gt;&gt; print epp.login.__doc__
    ...
    RETURN data: {...}
    ...
</pre><p>

<span class="emphasis"><em>POZOR!</em></span> V této verzi (1.0 beta release) má slovník tu vlastnost, že pokud
hodnota chybí, tak se klíč ve slovníku vůbec nevyskytuje. Dále, pokud je
v seznamu hodnot jen jedna položka, tak je typu string/unicode. Tyto
odlišnosti byste měli testovat.Ve finální verzi bude slovník pevně daný:
Klíč bude ve slovníku i když bude hodnota prázdná a seznam zůstane,
i když bude mít jen jednu položku.
</p><p>
Příklad: Když jsou vstupní data: 
</p><pre class="programlisting">
    name = 'jmeno'
    addr = (1,2,3)
    tech = ('ok',)
    stat = ''
</pre><p>

...tak se vytvoří takovýto slovník 'data':
</p><pre class="programlisting">
    {'name': 'jmeno',
     'addr':['1','2','3']
     'tech':'ok'           # tady je type str a stat chybí
    }
</pre><p>
...ale ve finální verzi by to mělo být takto:
</p><pre class="programlisting">
    {'name': 'jmeno',
     'addr':['1','2','3']
     'tech':['ok',]
     'stat':''
    }
</pre><p>

Návratovou hodnotu "retval" není nutné odchytávat, ukládá se do interní proměnné a lze ji kdykoliv
zobrazit funkcí print_answer():

</p><pre class="programlisting">
    &gt;&gt;&gt; epp.print_answer()
</pre><p>

nebo testovat jakoukoliv hodnotu v retval pomocí funkce is_val():

</p><pre class="programlisting">
    &gt;&gt;&gt; epp.is_val('reason')
    u'Text of answer reason'
</pre><p>

Každé volání další funkce EPP příkazu samozřejmě předchozí "retval" přepíše, takže uvedené dvě funkce
pracují vždy jen s poslední návratovou hodnotou. Pokud chcete návratovou hodnotu testovat nebo
zobrazit později, tak si ji uložte a pak ji předejte funkcím:

</p><pre class="programlisting">
    &gt;&gt;&gt; epp.print_answer(my_retval)
    &gt;&gt;&gt; epp.is_val('reason', my_retval)
</pre><p>

Funkci is_val() je možno zadat bez parametru. V takovém případě defaultně vrací hodnotu klíče "code":

</p><pre class="programlisting">
   &gt;&gt;&gt; epp.is_val()
    1000
</pre><p>

Pokud chcete zjistit hodnotu v jakékoliv vnořené části slovníku, tak zadejte parametr jako cestu - 
seznam jmen (klíčů) slovníku:

</p><pre class="programlisting">
    &gt;&gt;&gt; epp.is_val(('data','next-key'))
    next-value
</pre><p>

V případě, že daný klíč neexistuje, vrací funkce hodnotu None.

</p><pre class="programlisting">
    &gt;&gt;&gt; epp.is_val(('data','any-key'))
    None
</pre><p>

Pokud se vyskytne nějaká chyba při přenosu nebo jiná, která zablokuje funkčnost, tak se generuje
výjimka FredError.
</p></div></div></div></body></html>
